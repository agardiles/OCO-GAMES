<!DOCTYPE html>
<html>
<head>
    <title>Cazador 8-bit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #333;
            font-family: 'Courier New', monospace;
            touch-action: none;
            overflow: hidden;
        }

        #gameContainer {
            position: relative;
            width: 100%;
            max-width: 800px;
            text-align: center;
        }

        #gameCanvas {
            border: 4px solid #fff;
            background-color: #000;
            max-width: 100%;
            height: auto;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            color: #fff;
            font-size: 16px;
            margin: 10px;
            padding: 10px;
            background-color: #222;
            border: 2px solid #444;
        }

        .controls {
            color: #fff;
            font-size: 14px;
            margin: 10px;
            text-align: left;
            background-color: #222;
            padding: 10px;
            border: 2px solid #444;
        }

        #mobileControls {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .control-button {
            width: 60px;
            height: 60px;
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid #fff;
            border-radius: 50%;
            margin: 5px;
            color: white;
            font-size: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            touch-action: none;
        }

        #dpad {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
        }

        #actionButtons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .up { grid-column: 2; grid-row: 1; }
        .left { grid-column: 1; grid-row: 2; }
        .right { grid-column: 3; grid-row: 2; }
        .down { grid-column: 2; grid-row: 3; }

        @media (max-width: 768px) {
            #gameContainer {
                margin-bottom: 180px;
            }
            #mobileControls {
                display: block;
            }
            .controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div class="title" style="color: #fff; font-size: 24px; margin: 10px;">üéÆ CAZADOR 8-bit üéÆ</div>
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <div class="stats">
            <div id="score">Puntos: 0</div>
            <div id="level">Nivel: 1</div>
            <div id="highscore">Mejor: 0</div>
            <div id="hideTimer"></div>
        </div>
        <div class="controls">
            üéÆ PC: Flechas para Mover | ESPACIO Esconderse (5s) | R Reiniciar
        </div>
    </div>

    <div id="mobileControls">
        <div id="dpad">
            <button class="control-button up">‚Üë</button>
            <button class="control-button left">‚Üê</button>
            <button class="control-button right">‚Üí</button>
            <button class="control-button down">‚Üì</button>
        </div>
        <div id="actionButtons">
            <button class="control-button" id="hideButton">üëª</button>
            <button class="control-button" id="restartButton">üîÑ</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const highscoreElement = document.getElementById('highscore');
        const hideTimerElement = document.getElementById('hideTimer');

        // Detectar si es dispositivo m√≥vil
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        // Ajustar tama√±o del canvas para m√≥vil
        function resizeCanvas() {
            const container = document.getElementById('gameContainer');
            const maxWidth = Math.min(window.innerWidth - 40, 800);
            const scale = maxWidth / 400;
            canvas.style.width = `${400 * scale}px`;
            canvas.style.height = `${400 * scale}px`;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Variables del juego
        let score = 0;
        let highscore = 0;
        let level = 1;
        let gameLoop;
        let enemies = [];
        let powerUps = [];
        let hideTimeLeft = 0;
        let hideStartTime = 0;
        const HIDE_DURATION = 5000; // 5 segundos
        let bloodParticles = [];

        // Jugador
        const player = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            size: 20,
            speed: 5,
            isHidden: false,
            color: '#00ff00'
        };

        // Configuraci√≥n del nivel
        const levelConfig = {
            enemyCount: 3,
            enemySpeed: 1.5,
            powerUpCount: 2
        };

        // Controles de teclado
        const keys = {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false,
            Space: false
        };

        // Controles m√≥viles
        if (isMobile) {
            // Control direccional (D-pad)
            document.querySelectorAll('#dpad .control-button').forEach(button => {
                button.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    if (button.classList.contains('up')) keys.ArrowUp = true;
                    if (button.classList.contains('down')) keys.ArrowDown = true;
                    if (button.classList.contains('left')) keys.ArrowLeft = true;
                    if (button.classList.contains('right')) keys.ArrowRight = true;
                });

                button.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    if (button.classList.contains('up')) keys.ArrowUp = false;
                    if (button.classList.contains('down')) keys.ArrowDown = false;
                    if (button.classList.contains('left')) keys.ArrowLeft = false;
                    if (button.classList.contains('right')) keys.ArrowRight = false;
                });
            });

            // Bot√≥n de esconderse
            document.getElementById('hideButton').addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (!player.isHidden && hideTimeLeft <= 0) {
                    player.isHidden = true;
                    hideStartTime = Date.now();
                    hideTimeLeft = HIDE_DURATION;
                }
            });

            // Bot√≥n de reiniciar
            document.getElementById('restartButton').addEventListener('touchstart', (e) => {
                e.preventDefault();
                resetGame();
            });
        }

        // Controles de teclado (para PC)
        document.addEventListener('keydown', (e) => {
            if (e.code in keys) {
                e.preventDefault();
                keys[e.code] = true;
                if (e.code === 'Space' && !player.isHidden && hideTimeLeft <= 0) {
                    player.isHidden = true;
                    hideStartTime = Date.now();
                    hideTimeLeft = HIDE_DURATION;
                }
            }
            if (e.code === 'KeyR') {
                resetGame();
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.code in keys) {
                e.preventDefault();
                keys[e.code] = false;
            }
        });

        function createBloodParticles(x, y) {
            for(let i = 0; i < 30; i++) {
                bloodParticles.push({
                    x: x,
                    y: y,
                    dx: (Math.random() - 0.5) * 10,
                    dy: (Math.random() - 0.5) * 10,
                    size: Math.random() * 4 + 2,
                    life: 30
                });
            }
        }

        function updateBloodParticles() {
            bloodParticles = bloodParticles.filter(particle => {
                particle.x += particle.dx;
                particle.y += particle.dy;
                particle.life--;
                return particle.life > 0;
            });
        }

        function drawBloodParticles() {
            bloodParticles.forEach(particle => {
                ctx.fillStyle = '#ff0000';
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function initEnemies() {
            enemies = [];
            for (let i = 0; i < levelConfig.enemyCount; i++) {
                enemies.push({
                    x: Math.random() * (canvas.width - 20),
                    y: Math.random() * (canvas.height - 20),
                    size: 20,
                    speed: levelConfig.enemySpeed,
                    color: '#ff0000'
                });
            }
        }

        function initPowerUps() {
            powerUps = [];
            for (let i = 0; i < levelConfig.powerUpCount; i++) {
                powerUps.push({
                    x: Math.random() * (canvas.width - 15),
                    y: Math.random() * (canvas.height - 15),
                    size: 15,
                    color: '#ffff00'
                });
            }
        }

        function updatePlayer() {
            if (keys.ArrowUp && player.y > 0) player.y -= player.speed;
            if (keys.ArrowDown && player.y < canvas.height - player.size) player.y += player.speed;
            if (keys.ArrowLeft && player.x > 0) player.x -= player.speed;
            if (keys.ArrowRight && player.x < canvas.width - player.size) player.x += player.speed;
            
            if (player.isHidden) {
                hideTimeLeft = Math.max(0, HIDE_DURATION - (Date.now() - hideStartTime));
                hideTimerElement.textContent = `Escondido: ${Math.ceil(hideTimeLeft/1000)}s`;
                if (hideTimeLeft <= 0) {
                    player.isHidden = false;
                    hideTimerElement.textContent = '';
                }
            }
            
            player.color = player.isHidden ? '#003300' : '#00ff00';
        }

        function updateEnemies() {
            enemies.forEach(enemy => {
                if (!player.isHidden) {
                    const dx = player.x - enemy.x;
                    const dy = player.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    enemy.x += (dx / distance) * enemy.speed;
                    enemy.y += (dy / distance) * enemy.speed;
                } else {
                    enemy.x += (Math.random() - 0.5) * enemy.speed * 0.3;
                    enemy.y += (Math.random() - 0.5) * enemy.speed * 0.3;
                }

                enemy.x = Math.max(0, Math.min(canvas.width - enemy.size, enemy.x));
                enemy.y = Math.max(0, Math.min(canvas.height - enemy.size, enemy.y));
            });
        }

        function checkCollisions() {
            if (!player.isHidden) {
                enemies.forEach(enemy => {
                    const dx = player.x - enemy.x;
                    const dy = player.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < player.size + enemy.size) {
                        createBloodParticles(player.x, player.y);
                        gameOver();
                    }
                });
            }

            powerUps = powerUps.filter(powerUp => {
                const dx = player.x - powerUp.x;
                const dy = player.y - powerUp.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < player.size + powerUp.size) {
                    score += 10;
                    if (score > highscore) {
                        highscore = score;
                        highscoreElement.textContent = `Mejor: ${highscore}`;
                    }
                    scoreElement.textContent = `Puntos: ${score}`;
                    
                    if (score >= level * 50) {
                        levelUp();
                    }
                    return false;
                }
                return true;
            });

            if (powerUps.length === 0) {
                initPowerUps();
            }
        }

        function levelUp() {
            level++;
            levelElement.textContent = `Nivel: ${level}`;
            levelConfig.enemyCount++;
            levelConfig.enemySpeed += 0.2;
            initEnemies();
            initPowerUps();
        }

        function gameOver() {
            clearInterval(gameLoop);
            ctx.fillStyle = '#fff';
            ctx.font = '48px Courier New';
            ctx.fillText('¬°GAME OVER!', 70, canvas.height / 2);
            
            if (score > highscore) {
                highscore = score;
                highscoreElement.textContent = `Mejor: ${highscore}`;
                ctx.font = '24px Courier New';
                ctx.fillText('¬°NUEVO RECORD!', 70, canvas.height / 2 + 80);
            }
        }

        function resetGame() {
            score = 0;
            level = 1;
            levelConfig.enemyCount = 3</antArtifact>
